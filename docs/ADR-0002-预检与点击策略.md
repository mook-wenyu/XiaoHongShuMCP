# ADR-0002 预检与点击策略

状态：Accepted（破坏性更改）

日期：2025-09-12

## 背景
仅凭 DOM 可见性判断进行点击，容易在“禁用/加载/遮挡/动画”状态下反复重试，引发不必要的请求风暴与风控风险。

## 决策
- 新增 DomPreflightInspector：点击前做语义预检（aria-disabled/aria-busy/data-loading/role/tabindex/outerHTML采样）。
- HumanizedClickPolicy 流程：Preflight → ClickabilityDetector → regular → dispatchEvent → coordinate。
- 预检“不就绪且禁用”直接中止；“忙碌”短等待一次后复检。

## 影响
- ClickDecision 增加 PreflightReady/Reason；审计可观测性增强。

## 替代方案
- 单纯等待动画结束：不可靠且浪费时间；不具有语义信息。

## 度量
- 失败重试次数、每次点击的端到端时延、预检失败占比、坐标兜底比例。

