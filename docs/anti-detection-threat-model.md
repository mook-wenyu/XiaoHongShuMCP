# 反检测威胁模型（Threat Model）

版本：2025-09-12

## 1. 威胁面
- JavaScript 指示器：`navigator.webdriver`、权限 API、插件/媒体设备、堆栈特征、性能计时差异、字体/画布/WebGL 指纹。
- 网络/TLS：IP 信誉、自治系统（ASN）、TLS/JA3 指纹、HTTP2/3 行为、Cookie/ETag/指纹回放。
- 行为学：极端稳定/机械化轨迹、零误差、固定节律、非人类滚动/视野切换。
- 存储/画像：空白配置文件、异常历史、语言/时区/硬件/字体不一致。

## 2. 策略与控制
- 指纹生成：按 Persona 生成一致的 UA/UA-CH、语言/时区/屏幕/字体/媒体能力，并落盘到 Profile；
- JS 注入：在 `document_start` 注入补丁，隐藏自动化痕迹并保持可检测性（可审计变量快照）；
- 网络：住宅代理 + 粘性会话；IP 池健康度探测与淘汰；TLS/JA3 透传（依赖代理商支持）；
- 行为：人类化引擎生成轨迹与节律，插入误触与回撤；首屏关注与阅读时长控制；
- 监控：指标面板与告警，异常与封禁信号闭环到策略中心。

## 3. 验证与度量
- 指标：指纹一致性、脚本错误、请求失败分类、AB 版本成功率、会话存续时间、告警计数。
- 回放：操作事件流 + 截图/视频；指纹快照（前后对比）。

## 4. 限制与声明
- TLS/JA3 主动伪造复杂且风险高，建议通过代理层实现透传/随机化；
- 反检测策略需遵守目标平台政策与法律法规。

